{"version":3,"file":"Trade.js","names":["BaseModel","ModelHelper","Api","Trade","controller","modelFields","loaded","constructor","attributes","setGetters","currency","getCurrencyById","x","from_account","getUserAccountById","getById","id","callback","get","setDomain","process","env","REACT_APP_API_WHITESWAN_URL","where","with","orderBy","first"],"sources":["../../src/models/Trade.js"],"sourcesContent":["import BaseModel from \"./BaseModel\";\r\nimport ModelHelper from \"../helpers/ModelHelper\";\r\nimport {Api} from \"laravel-request\";\r\n\r\nexport default class Trade extends BaseModel\r\n{\r\n  /**\r\n   *\r\n   * @type {string}\r\n   */\r\n  controller = 'active_trade';\r\n\r\n  modelFields = {\r\n    'currency': {loaded: false},\r\n    'from_account': {loaded: false}\r\n  };\r\n\r\n  constructor(attributes)\r\n  {\r\n    super();\r\n    this.attributes = attributes;\r\n\r\n    this.setGetters(attributes);\r\n  }\r\n\r\n  get currency()\r\n  {\r\n    if (!this.modelFields.currency.loaded && this.attributes['currency_id'])\r\n    {\r\n      this.attributes['currency'] = ModelHelper.getCurrencyById(this.attributes['currency_id']);\r\n      this.modelFields.currency.loaded = true;\r\n    }\r\n\r\n    return this.attributes['currency'];\r\n  }\r\n\r\n  set currency(x)\r\n  {\r\n    return this.attributes['currency'] = x;\r\n  }\r\n\r\n  get from_account()\r\n  {\r\n    if (!this.modelFields.from_account.loaded && this.attributes['from_account_id'])\r\n    {\r\n      this.attributes['from_account'] = ModelHelper.getUserAccountById(this.attributes['from_account_id']);\r\n      this.modelFields.from_account.loaded = true;\r\n    }\r\n\r\n    return this.attributes['from_account'];\r\n  }\r\n\r\n  set from_account(x)\r\n  {\r\n    return this.attributes['from_account'] = x;\r\n  }\r\n\r\n  //TODO pass user_id for manager\r\n  static getById(id, callback)\r\n  {\r\n    Api.get('active-trade', 'index')\r\n      .setDomain(process.env.REACT_APP_API_WHITESWAN_URL)\r\n      .where('id', id)\r\n      .with('currency')\r\n      .with('to_account', 'to_account.currency', 'to_account.user_account')\r\n      .with('from_account', 'from_account.currency', 'from_account.user_account')\r\n      .with('get_account', 'get_account.currency')\r\n      .with('payments', 'payments.currency')\r\n      .with('commissions', 'commissions.currency')\r\n      .with('active', 'active.item', 'active.sell_trades', 'active.buy_trades')\r\n      .orderBy('trade_at', 'DESC')\r\n      .first(callback);\r\n  }\r\n}\r\n"],"mappings":"AAAA,OAAOA,SAAS,MAAM,aAAa;AACnC,OAAOC,WAAW,MAAM,wBAAwB;AAChD,SAAQC,GAAG,QAAO,iBAAiB;AAEnC,eAAe,MAAMC,KAAK,SAASH,SAAS,CAC5C;EACE;AACF;AACA;AACA;EACEI,UAAU,GAAG,cAAc;EAE3BC,WAAW,GAAG;IACZ,UAAU,EAAE;MAACC,MAAM,EAAE;IAAK,CAAC;IAC3B,cAAc,EAAE;MAACA,MAAM,EAAE;IAAK;EAChC,CAAC;EAEDC,WAAWA,CAACC,UAAU,EACtB;IACE,KAAK,CAAC,CAAC;IACP,IAAI,CAACA,UAAU,GAAGA,UAAU;IAE5B,IAAI,CAACC,UAAU,CAACD,UAAU,CAAC;EAC7B;EAEA,IAAIE,QAAQA,CAAA,EACZ;IACE,IAAI,CAAC,IAAI,CAACL,WAAW,CAACK,QAAQ,CAACJ,MAAM,IAAI,IAAI,CAACE,UAAU,CAAC,aAAa,CAAC,EACvE;MACE,IAAI,CAACA,UAAU,CAAC,UAAU,CAAC,GAAGP,WAAW,CAACU,eAAe,CAAC,IAAI,CAACH,UAAU,CAAC,aAAa,CAAC,CAAC;MACzF,IAAI,CAACH,WAAW,CAACK,QAAQ,CAACJ,MAAM,GAAG,IAAI;IACzC;IAEA,OAAO,IAAI,CAACE,UAAU,CAAC,UAAU,CAAC;EACpC;EAEA,IAAIE,QAAQA,CAACE,CAAC,EACd;IACE,OAAO,IAAI,CAACJ,UAAU,CAAC,UAAU,CAAC,GAAGI,CAAC;EACxC;EAEA,IAAIC,YAAYA,CAAA,EAChB;IACE,IAAI,CAAC,IAAI,CAACR,WAAW,CAACQ,YAAY,CAACP,MAAM,IAAI,IAAI,CAACE,UAAU,CAAC,iBAAiB,CAAC,EAC/E;MACE,IAAI,CAACA,UAAU,CAAC,cAAc,CAAC,GAAGP,WAAW,CAACa,kBAAkB,CAAC,IAAI,CAACN,UAAU,CAAC,iBAAiB,CAAC,CAAC;MACpG,IAAI,CAACH,WAAW,CAACQ,YAAY,CAACP,MAAM,GAAG,IAAI;IAC7C;IAEA,OAAO,IAAI,CAACE,UAAU,CAAC,cAAc,CAAC;EACxC;EAEA,IAAIK,YAAYA,CAACD,CAAC,EAClB;IACE,OAAO,IAAI,CAACJ,UAAU,CAAC,cAAc,CAAC,GAAGI,CAAC;EAC5C;;EAEA;EACA,OAAOG,OAAOA,CAACC,EAAE,EAAEC,QAAQ,EAC3B;IACEf,GAAG,CAACgB,GAAG,CAAC,cAAc,EAAE,OAAO,CAAC,CAC7BC,SAAS,CAACC,OAAO,CAACC,GAAG,CAACC,2BAA2B,CAAC,CAClDC,KAAK,CAAC,IAAI,EAAEP,EAAE,CAAC,CACfQ,IAAI,CAAC,UAAU,CAAC,CAChBA,IAAI,CAAC,YAAY,EAAE,qBAAqB,EAAE,yBAAyB,CAAC,CACpEA,IAAI,CAAC,cAAc,EAAE,uBAAuB,EAAE,2BAA2B,CAAC,CAC1EA,IAAI,CAAC,aAAa,EAAE,sBAAsB,CAAC,CAC3CA,IAAI,CAAC,UAAU,EAAE,mBAAmB,CAAC,CACrCA,IAAI,CAAC,aAAa,EAAE,sBAAsB,CAAC,CAC3CA,IAAI,CAAC,QAAQ,EAAE,aAAa,EAAE,oBAAoB,EAAE,mBAAmB,CAAC,CACxEC,OAAO,CAAC,UAAU,EAAE,MAAM,CAAC,CAC3BC,KAAK,CAACT,QAAQ,CAAC;EACpB;AACF"}