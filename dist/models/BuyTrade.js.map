{"version":3,"file":"BuyTrade.js","names":["ModelHelper","Trade","BuyTrade","constructor","attributes","setGetters","loadConvertTrade","modelFields","convert_trade","loaded","active","buy_trades","length","trade","price","originalPrice","accumulatedCouponPerOne","originalAccumulatedCouponPerOne","getCurrencyById"],"sources":["../../src/models/BuyTrade.js"],"sourcesContent":["import ModelHelper from \"../helpers/ModelHelper\";\r\nimport Trade from \"./Trade\";\r\n\r\nexport default class BuyTrade extends Trade\r\n{\r\n  constructor(attributes)\r\n  {\r\n    super();\r\n    this.attributes = attributes;\r\n\r\n    this.setGetters(attributes);\r\n  }\r\n\r\n  loadConvertTrade()\r\n  {\r\n    if (!this.modelFields.convert_trade.loaded && this.attributes?.convert_trade?.active?.buy_trades?.length > 0)\r\n    {\r\n      let trade = this.attributes?.convert_trade?.active?.buy_trades[0]\r\n      //находим пропорционально цену 1 лота\r\n      let price = 0,\r\n        originalPrice = 0,\r\n        accumulatedCouponPerOne = 0,\r\n        originalAccumulatedCouponPerOne = 0;\r\n\r\n      if (trade['count'] > 0)\r\n      {\r\n        price = trade['sum'] / trade['count'];\r\n        originalPrice = trade['original_sum'] / trade['count'];\r\n\r\n        accumulatedCouponPerOne = trade['accumulated_coupon'] / trade['count'];\r\n        originalAccumulatedCouponPerOne = trade['original_accumulated_coupon'] / trade['count'];\r\n      }\r\n\r\n      this.attributes['currency'] = ModelHelper.getCurrencyById(trade['currency_id']);\r\n      // this.attributes['id'] = trade['id'];//нельзя менять id так как будет открываться на редатирование старый трейд\r\n      this.attributes['price'] = price;\r\n      this.attributes['original_price'] = originalPrice;\r\n      this.attributes['sum'] = this.attributes['count'] * price;\r\n      this.attributes['original_sum'] = this.attributes['count'] * originalPrice;\r\n      this.attributes['count'] = this.attributes['count'];\r\n      this.attributes['accumulated_coupon'] = this.attributes['count'] * accumulatedCouponPerOne;\r\n      this.attributes['original_accumulated_coupon'] = this.attributes['count'] * originalAccumulatedCouponPerOne;\r\n      this.attributes['type_id'] = trade['type_id'];\r\n      this.attributes['trade_at'] = trade['trade_at'];\r\n      this.attributes['trade_at_date'] = trade['trade_at_date'];\r\n      this.attributes['trade_at_datetime'] = trade['trade_at_datetime'];\r\n\r\n      this.modelFields.convert_trade.loaded = true;\r\n    }\r\n  }\r\n}"],"mappings":"AAAA,OAAOA,WAAW,MAAM,wBAAwB;AAChD,OAAOC,KAAK,MAAM,SAAS;AAE3B,eAAe,MAAMC,QAAQ,SAASD,KAAK,CAC3C;EACEE,WAAWA,CAACC,UAAU,EACtB;IACE,KAAK,CAAC,CAAC;IACP,IAAI,CAACA,UAAU,GAAGA,UAAU;IAE5B,IAAI,CAACC,UAAU,CAACD,UAAU,CAAC;EAC7B;EAEAE,gBAAgBA,CAAA,EAChB;IACE,IAAI,CAAC,IAAI,CAACC,WAAW,CAACC,aAAa,CAACC,MAAM,IAAI,IAAI,CAACL,UAAU,EAAEI,aAAa,EAAEE,MAAM,EAAEC,UAAU,EAAEC,MAAM,GAAG,CAAC,EAC5G;MACE,IAAIC,KAAK,GAAG,IAAI,CAACT,UAAU,EAAEI,aAAa,EAAEE,MAAM,EAAEC,UAAU,CAAC,CAAC,CAAC;MACjE;MACA,IAAIG,KAAK,GAAG,CAAC;QACXC,aAAa,GAAG,CAAC;QACjBC,uBAAuB,GAAG,CAAC;QAC3BC,+BAA+B,GAAG,CAAC;MAErC,IAAIJ,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EACtB;QACEC,KAAK,GAAGD,KAAK,CAAC,KAAK,CAAC,GAAGA,KAAK,CAAC,OAAO,CAAC;QACrCE,aAAa,GAAGF,KAAK,CAAC,cAAc,CAAC,GAAGA,KAAK,CAAC,OAAO,CAAC;QAEtDG,uBAAuB,GAAGH,KAAK,CAAC,oBAAoB,CAAC,GAAGA,KAAK,CAAC,OAAO,CAAC;QACtEI,+BAA+B,GAAGJ,KAAK,CAAC,6BAA6B,CAAC,GAAGA,KAAK,CAAC,OAAO,CAAC;MACzF;MAEA,IAAI,CAACT,UAAU,CAAC,UAAU,CAAC,GAAGJ,WAAW,CAACkB,eAAe,CAACL,KAAK,CAAC,aAAa,CAAC,CAAC;MAC/E;MACA,IAAI,CAACT,UAAU,CAAC,OAAO,CAAC,GAAGU,KAAK;MAChC,IAAI,CAACV,UAAU,CAAC,gBAAgB,CAAC,GAAGW,aAAa;MACjD,IAAI,CAACX,UAAU,CAAC,KAAK,CAAC,GAAG,IAAI,CAACA,UAAU,CAAC,OAAO,CAAC,GAAGU,KAAK;MACzD,IAAI,CAACV,UAAU,CAAC,cAAc,CAAC,GAAG,IAAI,CAACA,UAAU,CAAC,OAAO,CAAC,GAAGW,aAAa;MAC1E,IAAI,CAACX,UAAU,CAAC,OAAO,CAAC,GAAG,IAAI,CAACA,UAAU,CAAC,OAAO,CAAC;MACnD,IAAI,CAACA,UAAU,CAAC,oBAAoB,CAAC,GAAG,IAAI,CAACA,UAAU,CAAC,OAAO,CAAC,GAAGY,uBAAuB;MAC1F,IAAI,CAACZ,UAAU,CAAC,6BAA6B,CAAC,GAAG,IAAI,CAACA,UAAU,CAAC,OAAO,CAAC,GAAGa,+BAA+B;MAC3G,IAAI,CAACb,UAAU,CAAC,SAAS,CAAC,GAAGS,KAAK,CAAC,SAAS,CAAC;MAC7C,IAAI,CAACT,UAAU,CAAC,UAAU,CAAC,GAAGS,KAAK,CAAC,UAAU,CAAC;MAC/C,IAAI,CAACT,UAAU,CAAC,eAAe,CAAC,GAAGS,KAAK,CAAC,eAAe,CAAC;MACzD,IAAI,CAACT,UAAU,CAAC,mBAAmB,CAAC,GAAGS,KAAK,CAAC,mBAAmB,CAAC;MAEjE,IAAI,CAACN,WAAW,CAACC,aAAa,CAACC,MAAM,GAAG,IAAI;IAC9C;EACF;AACF"}